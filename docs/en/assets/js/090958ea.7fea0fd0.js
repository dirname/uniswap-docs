"use strict";(self.webpackChunk_uniswap_docs=self.webpackChunk_uniswap_docs||[]).push([[1343],{76958:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var r=n(83117),i=(n(67294),n(3905));const o={id:"v4-architecture-overview",title:"V4 Architecture Overview",sidebar_position:1},a="Architecture",c={unversionedId:"contracts/v4/concepts/v4-architecture-overview",id:"contracts/v4/concepts/v4-architecture-overview",title:"V4 Architecture Overview",description:"In Uniswap V3, each pool has its own contract instance, which makes initializing pools and performing swaps in multiple pools costly.",source:"@site/docs/contracts/v4/concepts/02-1-overview.mdx",sourceDirName:"contracts/v4/concepts",slug:"/contracts/v4/concepts/v4-architecture-overview",permalink:"/uniswap-docs/en/contracts/v4/concepts/v4-architecture-overview",editUrl:"https://github.com/uniswap/uniswap-docs/tree/main/docs/contracts/v4/concepts/02-1-overview.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"v4-architecture-overview",title:"V4 Architecture Overview",sidebar_position:1},sidebar:"contractsSidebar",previous:{title:"Introduction to Uniswap V4",permalink:"/uniswap-docs/en/contracts/v4/concepts/intro-to-v4"},next:{title:"Pool Manager and Pool Initialization",permalink:"/uniswap-docs/en/contracts/v4/concepts/pool-manager-and-pool-initialization"}},s={},l=[],p={toc:l};function u(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"architecture"},"Architecture"),(0,i.kt)("p",null,"In Uniswap V3, each pool has its own contract instance, which makes initializing pools and performing swaps in multiple pools costly.\nWhereas, in V4, all pools are kept in a single contract to provide substantial gas savings."),(0,i.kt)("p",null,(0,i.kt)("img",{loading:"lazy",alt:"High Level Architecture",src:n(22407).Z,width:"2038",height:"984"})),(0,i.kt)("p",null,(0,i.kt)("img",{loading:"lazy",alt:"High Level Architecture",src:n(19976).Z,width:"2208",height:"810"})),(0,i.kt)("p",null,"Early calculations say that V4 will\nmake the gas cost of creating pools 99% less. Hooks offer unlimited choices and the single contract lets you easily\nmove through all these choices."),(0,i.kt)("p",null,'This Singleton design is improved by a new "flash accounting" method. Instead of moving assets in and out of pools\nafter each swap in V3, this method only moves the net balances. This means the system is a lot more efficient and\nsaves even more gas in Uniswap V4.'),(0,i.kt)("p",null,(0,i.kt)("img",{loading:"lazy",alt:"V3 Detailed Architecture",src:n(68992).Z,width:"1179",height:"415"})),(0,i.kt)("p",null,(0,i.kt)("img",{loading:"lazy",alt:"V4 Detailed Architecture",src:n(34944).Z,width:"1226",height:"719"})),(0,i.kt)("p",null,"Because of the efficiency of the Singleton contract and flash accounting, there is no need to limit fee tiers. People\nwho create pools can choose them to be most competitive or change them with a dynamic fee hook. V4 also supports\nnative ETH again, which helps save more gas."))}u.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=l(n),h=i,v=d["".concat(s,".").concat(h)]||d[h]||u[h]||o;return n?r.createElement(v,a(a({ref:t},p),{},{components:n})):r.createElement(v,a({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:i,a[1]=c;for(var l=2;l<o;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},68992:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/v3_detailed_architecture-783d0acdac88743c78dd8159ac4783ef.png"},22407:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/v3_high_level_architecture-f0d03e7ebae039bff8caa999ad0a9de9.png"},34944:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/v4_detailed_architecture-b3895cdac729e04810fd20fb046c170e.png"},19976:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/v4_high_level_architecture-302ecfe24d7979e18dd03dc13e3d9e3b.png"}}]);